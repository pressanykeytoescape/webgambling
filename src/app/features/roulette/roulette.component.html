<div class="roulette-container">
    <!-- Background particles -->
    <div class="roulette-particles">
        <ng-container *ngFor="let particle of particles; index as i">
            <div class="roulette-particle"
                 [style.left.px]="particle.x"
                 [style.animation-delay.s]="particle.delay">
            </div>
        </ng-container>
    </div>

    <!-- Roulette title -->
    <h1 class="roulette-title text-6xl font-bold text-center mb-8">
        üé∞ ROULETTE üé∞
    </h1>

    <!-- Main roulette table -->
    <div class="roulette-table">
        <!-- Wheel section -->
        <div class="wheel-section">
            <div class="wheel-container">
                <div class="wheel-base">
                    <!-- Outer rim -->
                    <div class="wheel-outer-rim"></div>

                    <!-- Unser Wheel: conic-gradient + Dauerrotation -->
                    <div class="roulette-wheel" #wheelEl
                         [style.background]="bg()"
                         [style.transform]="'rotate(' + rotation() + 'deg)'">


                    <!-- Zahlen als Labels um den Kreis -->
                        <ng-container *ngFor="let p of wheel; index as i">
                            <div class="label" [style.transform]="labelTransform(i)">{{ p.n }}</div>
                        </ng-container>


                        <!-- Wheel center -->
                        <div class="wheel-center">
                            <div class="center-logo">üé≤</div>
                        </div>
                    </div>

                    <!-- Ball -->
                    <div class="ball-pivot"
                         [style.transform]="'translate(-50%, -50%) rotate(' + ballAngle() + 'deg)'">
                        <div class="roulette-ball"
                             [style.transform]="'translateY(-' + ballRadius + 'px)'">
                            <div class="ball-inner"></div>
                        </div>
                    </div>

                    <!-- Pointer -->
                    <div class="wheel-pointer"></div>
                </div>
            </div>
        </div>

        <!-- Betting board -->
        <div class="betting-board">
            <div class="betting-grid">
                <!-- Number grid -->
                <div class="number-grid">
                    <!-- Zero -->
                    <div class="bet-cell zero-cell"
                         [class.selected]="betType === 'number' && betValue === 0"
                         (click)="selectNumberBet(0)">
                        0
                    </div>

                    <ng-container *ngFor="let num of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]; index as i">
                        <div class="bet-cell number-cell"
                             [class.red]="isRedNumber(num)"
                             [class.black]="isBlackNumber(num)"
                             [class.selected]="betType === 'number' && betValue === num"
                             [class.winning]="winningNumber === num"
                             (click)="selectNumberBet(num)">
                            {{ num }}
                        </div>
                    </ng-container>
                </div> <!-- /number-grid -->

                <!-- Outside bets -->
                <div class="outside-bets">
                    <div class="bet-row">
                        <div class="bet-cell outside-bet red-bet"
                             [class.selected]="betType === 'color' && betValue === 'red'"
                             (click)="selectColorBet('red')">
                            <span class="bet-icon">‚ô¶</span>
                            <span>ROT</span>
                        </div>
                        <div class="bet-cell outside-bet black-bet"
                             [class.selected]="betType === 'color' && betValue === 'black'"
                             (click)="selectColorBet('black')">
                            <span class="bet-icon">‚ô†</span>
                            <span>SCHWARZ</span>
                        </div>
                    </div>

                    <div class="bet-row">
                        <div class="bet-cell outside-bet"
                             [class.selected]="betType === 'even'"
                             (click)="selectBetType('even')">
                            GERADE
                        </div>
                        <div class="bet-cell outside-bet"
                             [class.selected]="betType === 'odd'"
                             (click)="selectBetType('odd')">
                            UNGERADE
                        </div>
                    </div>

                    <div class="bet-row">
                        <div class="bet-cell outside-bet dozen-bet"
                             [class.selected]="betType === 'dozen1'"
                             (click)="selectBetType('dozen1')">
                            1-12
                        </div>
                        <div class="bet-cell outside-bet dozen-bet"
                             [class.selected]="betType === 'dozen2'"
                             (click)="selectBetType('dozen2')">
                            13-24
                        </div>
                        <div class="bet-cell outside-bet dozen-bet"
                             [class.selected]="betType === 'dozen3'"
                             (click)="selectBetType('dozen3')">
                            25-36
                        </div>
                    </div>
                </div> <!-- /outside-bets -->

            </div> <!-- /betting-grid -->
        </div> <!-- /betting-board -->
    </div> <!-- /roulette-table -->

    <!-- Control panel -->
    <div class="roulette-controls">
        <div class="bet-section-roulette">
            <div class="bet-label-roulette">EINSATZ</div>
            <div class="bet-controls-roulette">
                <button class="bet-btn-roulette" (click)="decreaseBet()" [disabled]="spinning || bet <= minBet">-</button>
                <input  class="bet-input-roulette" [(ngModel)]="bet" [min]="minBet" type="number" [disabled]="spinning">
                <button class="bet-btn-roulette" (click)="increaseBet()" [disabled]="spinning">+</button>
            </div>
        </div>

        <button class="spin-btn-roulette" [class.pulse]="!spinning && betType"
                [disabled]="spinning || !betType" (click)="spin()">
            <div class="btn-icon-roulette">üéØ</div>
            <div class="btn-text-roulette">{{ spinning ? 'SPINNING...' : 'SPIN' }}</div>
        </button>

        <button class="allin-btn-roulette" [disabled]="spinning || !currentBalance || !betType"
                (click)="allIn(currentBalance)">
            <div class="btn-icon-roulette">üí∏</div>
            <div class="btn-text-roulette">ALL IN</div>
        </button>

        <button class="clear-btn-roulette" [disabled]="spinning" (click)="clearBets()">
            <div class="btn-icon-roulette">üóëÔ∏è</div>
            <div class="btn-text-roulette">CLEAR</div>
        </button>
    </div>

    <!-- Result display -->
    <ng-container *ngIf="resultMessage">
        <div class="result-display-roulette">
            <div class="result-content-roulette" [class]="getResultClass()">
                <div class="result-animation-roulette" *ngIf="isWinning()">üéâ</div>
                <div class="result-text-roulette">{{ resultMessage }}</div>

                <ng-container *ngIf="winningNumber !== null">
                    <div class="winning-number-display">
                        <span class="winning-label">Winning Number:</span>
                        <span class="winning-number"
                              [class.red]="isRedNumber(winningNumber!)"
                              [class.black]="isBlackNumber(winningNumber!)"
                              [class.green]="winningNumber === 0">
              {{ winningNumber }}
            </span>
                    </div>
                </ng-container>
            </div>
        </div>
    </ng-container>

    <!-- Game info -->
    <div class="game-info-roulette">
        <div class="balance-display-roulette">
            <span class="balance-label-roulette">BALANCE:</span>
            <span class="balance-amount-roulette">{{ balance$ | async }}‚Ç¨</span>
        </div>
        <a routerLink="/lobby" class="back-button-roulette">‚Üê ZUR√úCK ZUR LOBBY</a>
    </div>
</div>
